<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Authorization</title>
    <style>
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div id="auth-section">
        <h2>Авторизация</h2>
        <input type="password" id="secret-code" placeholder="Введите секретный код">
        <button onclick="authorize()">Авторизоваться</button>
        <p id="auth-message"></p>
    </div>
    <div id="app-section" class="hidden">
        <h2>Добавить штраф</h2>
        <form id="fine-form">
            <label for="name">Фамилия Имя:</label>
            <input type="text" id="name" name="name" required><br><br>

            <label for="date">Дата:</label>
            <input type="date" id="date" name="date" required><br><br>

            <label for="reason">Причина:</label>
            <input type="text" id="reason" name="reason" required><br><br>

            <label for="amount">Сумма:</label>
            <input type="number" id="amount" name="amount" required><br><br>

            <button type="button" onclick="addFine()">Добавить штраф</button>
        </form>

        <button onclick="toggleFinesList()">Показать список штрафов</button>
        <div id="fines-list" class="hidden">
            <h2>Список штрафов</h2>
            <div id="fines-container"></div>
        </div>
    </div>

    <script>
        let authorized = false;

        function authorize() {
            const secretCode = document.getElementById('secret-code').value;
            const authMessage = document.getElementById('auth-message');
            if (secretCode === '250') {
                document.getElementById('auth-section').classList.add('hidden');
                document.getElementById('app-section').classList.remove('hidden');
                authMessage.textContent = '';
                authorized = true;
                loadFines();
            } else {
                authMessage.textContent = 'Неправильный код!';
            }
        }

        function addFine() {
            const name = document.getElementById('name').value;
            const date = document.getElementById('date').value;
            const reason = document.getElementById('reason').value;
            const amount = document.getElementById('amount').value;

            const fine = { name, date, reason, amount };
            saveFine(fine);
            renderFine(fine);

            document.getElementById('fine-form').reset();
        }

        function saveFine(fine) {
            const fines = getFines();
            fines.push(fine);
            localStorage.setItem('fines', JSON.stringify(fines));
        }

        function getFines() {
            const fines = localStorage.getItem('fines');
            return fines ? JSON.parse(fines) : [];
        }

        function renderFine(fine) {
            const fineEntry = document.createElement('div');
            fineEntry.textContent = `Фамилия Имя: ${fine.name}, Дата: ${fine.date}, Причина: ${fine.reason}, Сумма: ${fine.amount}`;
            fineEntry.appendChild(createDeleteButton(fineEntry, fine));

            document.getElementById('fines-container').appendChild(fineEntry);
        }

        function createDeleteButton(fineEntry, fine) {
            const deleteButton = document.createElement('button');
            deleteButton.textContent = 'Удалить';
            deleteButton.onclick = function() {
                if (authorized) {
                    fineEntry.remove();
                    removeFine(fine);
                } else {
                    alert('Вы не авторизованы для удаления штрафов.');
                }
            };
            return deleteButton;
        }

        function removeFine(fine) {
            let fines = getFines();
            fines = fines.filter(f => !(f.name === fine.name && f.date === fine.date && f.reason === fine.reason && f.amount === fine.amount));
            localStorage.setItem('fines', JSON.stringify(fines));
        }

        function loadFines() {
            const fines = getFines();
            fines.forEach(fine => renderFine(fine));
        }

        function toggleFinesList() {
            const finesList = document.getElementById('fines-list');
            if (finesList.classList.contains('hidden')) {
                finesList.classList.remove('hidden');
            } else {
                finesList.classList.add('hidden');
            }
        }
    </script>
</body>
</html>